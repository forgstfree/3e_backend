(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-782774e9"],{"08ae":function(t,e,i){"use strict";i("2457")},"0f3f":function(t,e,i){"use strict";i("6217")},1993:function(t,e,i){},"199c":function(t,e,i){"use strict";i.d(e,"b",(function(){return l})),i.d(e,"d",(function(){return n})),i.d(e,"c",(function(){return s})),i.d(e,"a",(function(){return o}));var a=i("b775");function l(t){return Object(a["a"])({baseURL:Object({VUE_APP_BASE_API:"/prod-api",NODE_ENV:"production",BASE_URL:"/"}).VUE_APP_BASE_URL,url:"/model/model/",method:"post",data:t})}function n(t){return Object(a["a"])({baseURL:Object({VUE_APP_BASE_API:"/prod-api",NODE_ENV:"production",BASE_URL:"/"}).VUE_APP_BASE_URL,url:"/model/list/",method:"get",params:t})}function s(t){return Object(a["a"])({baseURL:Object({VUE_APP_BASE_API:"/prod-api",NODE_ENV:"production",BASE_URL:"/"}).VUE_APP_BASE_URL,url:"/model/delete/",method:"post",data:t})}function o(t){return Object(a["a"])({baseURL:Object({VUE_APP_BASE_API:"/prod-api",NODE_ENV:"production",BASE_URL:"/"}).VUE_APP_BASE_URL,url:"/model/analysis/",method:"post",data:t})}},"1b65":function(t,e,i){"use strict";i.d(e,"d",(function(){return l})),i.d(e,"c",(function(){return n})),i.d(e,"e",(function(){return s})),i.d(e,"a",(function(){return o})),i.d(e,"b",(function(){return r}));var a=i("b775");function l(t){return Object(a["a"])({baseURL:Object({VUE_APP_BASE_API:"/prod-api",NODE_ENV:"production",BASE_URL:"/"}).VUE_APP_BASE_URL,url:"/file/list/",method:"get",params:t})}function n(t){return Object(a["a"])({baseURL:Object({VUE_APP_BASE_API:"/prod-api",NODE_ENV:"production",BASE_URL:"/"}).VUE_APP_BASE_URL,url:"/file/headerlist/",method:"get",params:t})}function s(t){return Object(a["a"])({baseURL:Object({VUE_APP_BASE_API:"/prod-api",NODE_ENV:"production",BASE_URL:"/"}).VUE_APP_BASE_URL,url:"/file/fileinfo/",method:"post",data:t})}function o(t){return Object(a["a"])({baseURL:Object({VUE_APP_BASE_API:"/prod-api",NODE_ENV:"production",BASE_URL:"/"}).VUE_APP_BASE_URL,url:"/file/deletefile/",method:"post",data:t})}function r(t){return Object(a["a"])({baseURL:Object({VUE_APP_BASE_API:"/prod-api",NODE_ENV:"production",BASE_URL:"/"}).VUE_APP_BASE_URL,url:"/file/downloadfile/",method:"get",responseType:"blob",params:t})}},2457:function(t,e,i){},6217:function(t,e,i){},"73f7":function(t,e,i){"use strict";i("f506")},af00:function(t,e,i){"use strict";i("1993")},f3b0:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"app-container"},[i("div",{staticClass:"build-container"},[i("el-steps",{attrs:{active:t.active,"finish-status":"success"}},[i("el-step",{attrs:{title:"步骤 1",description:"选择模型"}},[t._v("1")]),i("el-step",{attrs:{title:"步骤 2",description:"选择数据"}},[t._v("2")]),i("el-step",{attrs:{title:"步骤 3",description:"字段映射"}},[t._v("3")]),i("el-step",{attrs:{title:"步骤 4",description:"分析"}},[t._v("4")])],1),i("el-button",{staticStyle:{"margin-top":"12px"},attrs:{disabled:1===t.active},on:{click:t.last}},[t._v("上一步")]),i("el-button",{staticStyle:{"margin-top":"12px","margin-bottom":"12px"},attrs:{disabled:4===t.active,type:"primary"},on:{click:t.next}},[t._v("下一步")]),i("div",{ref:"modelContainer",staticClass:"modelContainer"},[i("div",{directives:[{name:"show",rawName:"v-show",value:1===t.active,expression:"active === 1"}],staticClass:"step1"},[i("Model3E",{ref:"model",on:{change:t.handleModel}})],1),i("div",{directives:[{name:"show",rawName:"v-show",value:2===t.active,expression:"active === 2"}],staticClass:"step2"},[i("Datafields",{ref:"datafields"})],1),i("div",{directives:[{name:"show",rawName:"v-show",value:3===t.active,expression:"active === 3"}],staticClass:"step3"},[i("Mapper",{ref:"mapper",attrs:{"model-list":t.selectedModel,"data-list":t.selectedData}})],1),i("div",{directives:[{name:"show",rawName:"v-show",value:4===t.active,expression:"active === 4"}],staticClass:"step4"},[i("ShowResult",{ref:"showresult",attrs:{height:t.height,width:t.width}})],1)])],1)])},l=[];i("d81d"),i("159b"),i("b64b"),i("2b0e"),i("b311");var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("el-row",{attrs:{gutter:20}},[i("el-col",{attrs:{span:6}},[i("div",{},[t._v(" 模型名: "),i("el-select",{attrs:{clearable:"",filterable:"",placeholder:"请选择"},on:{clear:t.cleartmp,change:t.changeIndex},model:{value:t.selectModelIndex,callback:function(e){t.selectModelIndex=e},expression:"selectModelIndex"}},t._l(t.list,(function(t,e){return i("el-option",{key:t.pk,attrs:{label:t.fields.name,value:e}})})),1)],1)])],1),i("el-row",{attrs:{gutter:20}},[i("el-col",{attrs:{span:4}},[i("div",{},[t._v("公式:")])]),i("el-col",{attrs:{span:20}},[i("div",{},[i("vue-mathjax",{attrs:{formula:t.tmp.fields.expression}})],1)])],1),i("el-row",{attrs:{gutter:20}},[i("el-col",{attrs:{span:4}},[i("div",{},[t._v("公式描述:")])]),i("el-col",{attrs:{span:20}},[i("div",{},[i("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:"请输入内容"},model:{value:t.tmp.fields.desc,callback:function(e){t.$set(t.tmp.fields,"desc",e)},expression:"tmp.fields.desc"}})],1)])],1),i("el-row",{attrs:{gutter:20}},[i("el-col",{attrs:{span:4}},[i("div",{},[t._v("公式备注:")])]),i("el-col",{attrs:{span:20}},[i("div",{},[i("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:"请输入内容"},model:{value:t.tmp.fields.remake,callback:function(e){t.$set(t.tmp.fields,"remake",e)},expression:"tmp.fields.remake"}})],1)])],1),i("el-row",{attrs:{gutter:20}},[i("el-col",{attrs:{span:12}},[i("div",[t._v("系数区")]),i("div",[i("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tmp.coefficient}},[i("el-table-column",{attrs:{prop:"key",label:"名称",width:"180"}}),i("el-table-column",{attrs:{prop:"value",label:"预定义值"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.edit?[i("el-input",{staticClass:"edit-input",attrs:{size:"small"},model:{value:e.row.value,callback:function(i){t.$set(e.row,"value",i)},expression:"scope.row.value"}}),i("el-button",{staticClass:"cancel-btn",attrs:{size:"small",icon:"el-icon-refresh",type:"warning"},on:{click:function(i){return t.cancelEdit(e.row)}}},[t._v(" cancel ")])]:i("span",[t._v(t._s(e.row.value))])]}}])}),i("el-table-column",{attrs:{label:"操作",width:"250",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.edit?i("el-button",{attrs:{type:"success",size:"mini",icon:"el-icon-circle-check-outline"},on:{click:function(i){return t.confirmEdit(e.row)}}},[t._v(" 确认 ")]):i("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-edit"},on:{click:function(t){e.row.edit=!e.row.edit}}},[t._v(" 编辑 ")]),i("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(i){return t.handleDelete(e.$index)}}},[t._v("删除 ")])]}}])})],1),i("p",{staticClass:"newline",on:{click:function(e){t.dialogVisible=!0}}},[t._v("增加一行")])],1)]),i("el-col",{attrs:{span:12}},[i("div",{staticStyle:{"margin-bottom":"20px"}},[t._v("变量区")]),i("div",[t._l(t.tmp.variable,(function(e){return i("el-tag",{key:e,attrs:{closable:"","disable-transitions":!1},on:{close:function(i){return t.handleClose(e)}}},[t._v(" "+t._s(e)+" ")])})),t.inputVisible?i("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{size:"small"},on:{blur:t.handleInputConfirm},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleInputConfirm(e)}},model:{value:t.inputValue,callback:function(e){t.inputValue=e},expression:"inputValue"}}):i("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:t.showInput}},[t._v("+ 新变量")])],2)])],1),i("div",[i("el-dialog",{attrs:{title:"新增系数",visible:t.dialogVisible,width:"30%","before-close":t.diahandleClose},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("div",[i("el-row",{attrs:{gutter:20}},[i("el-col",{attrs:{span:6}},[i("div",{},[t._v("参数名称：")])]),i("el-col",{attrs:{span:18}},[i("div",{},[i("el-input",{attrs:{placeholder:"请输入参数名称"},model:{value:t.coefficient.key,callback:function(e){t.$set(t.coefficient,"key",e)},expression:"coefficient.key"}})],1)])],1),i("el-row",{attrs:{gutter:20}},[i("el-col",{attrs:{span:6}},[i("div",{},[t._v("预定义系数值：")])]),i("el-col",{attrs:{span:18}},[i("div",{},[i("el-input",{attrs:{placeholder:"请输入参数预定义值"},model:{value:t.coefficient.value,callback:function(e){t.$set(t.coefficient,"value",e)},expression:"coefficient.value"}})],1)])],1)],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:t.handleNewCoe}},[t._v("确 定")])],1)])],1)],1)},s=[],o=(i("ac1f"),i("1276"),i("a434"),i("199c")),r=i("7b93"),c={name:"ModelSelect",components:{"vue-mathjax":r["VueMathjax"]},data:function(){return{list:[],inputVisible:!1,inputValue:"",dialogVisible:!1,coefficient:{originKey:"",originValue:"",key:"",value:"",edit:!1},selectModelIndex:"",tmp:{pk:"",model:"",variable:[],coefficient:[],fields:{coefficient:"",desc:"",examples:"",name:"",remake:"",variable:""}}}},mounted:function(){this.fetchData()},methods:{fetchData:function(){var t=this;Object(o["d"])().then((function(e){var i=e.list;t.list=i,console.log(t.list)}))},cleartmp:function(){var t=this;Object.keys(this.tmp).forEach((function(e){t.tmp.hasOwnProperty(e)&&(t.tmp[e]=null)}))},changeIndex:function(t){this.cleartmp(),this.tmp=JSON.parse(JSON.stringify(this.list[t])),this.tmp.coefficient=JSON.parse(this.tmp.fields.coefficient),this.tmp.variable=this.tmp.fields.variable.split(",")},handleNewCoe:function(){this.dialogVisible=!1,this.coefficient.originKey=this.coefficient.key,this.coefficient.originValue=this.coefficient.value;var t=JSON.parse(JSON.stringify(this.coefficient));this.tmp.coefficient.push(t),this.coefficient={originKey:"",originValue:"",key:"",value:"",edit:!1},console.log(this.tmp)},diahandleClose:function(t){this.$confirm("确认关闭？,数据将不会被保存！").then((function(t){})).catch((function(t){}))},handleClose:function(t){this.tmp.variable.splice(this.tmp.variable.indexOf(t),1)},showInput:function(){var t=this;this.inputVisible=!0,this.$nextTick((function(e){t.$refs.saveTagInput.$refs.input.focus()}))},handleInputConfirm:function(){var t=this.inputValue;t&&this.tmp.variable.push(t),this.inputVisible=!1,this.inputValue=""},cancelEdit:function(t){t.value=t.originValue,t.edit=!1,this.$message({message:"The coefficient has been restored to the original value",type:"warning"})},confirmEdit:function(t){t.edit=!1,t.originValue=t.value,this.$message({message:"The value has been edited",type:"success"})},handleDelete:function(t){this.tmp.coefficient.splice(t,1),this.$message({message:"系数已经成功删除",type:"success"})},getSelection:function(){console.log(this.tmp),console.log(this.tmp),console.log(this.tmp)}}},d=c,u=(i("af00"),i("2877")),f=Object(u["a"])(d,n,s,!1,null,"73477a0b",null),p=f.exports,h=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.listData,"tooltip-effect":"dark"},on:{"selection-change":t.handleSelectionChange}},[i("el-table-column",{attrs:{type:"selection",width:"55"}}),i("el-table-column",{attrs:{prop:"fields.filename",label:"表名",width:"220"}}),i("el-table-column",{attrs:{prop:"fields.sheetname",label:"SHEET",width:"120"}}),i("el-table-column",{attrs:{label:"字段","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._l(e.row.fields.headers,(function(e){return i("el-tag",{key:e,attrs:{type:"success","disable-transitions":!1}},[t._v(" "+t._s(e)+" ")])})),i("div")]}}])})],1),i("div",{staticStyle:{"margin-top":"20px"}})],1)},m=[],v=i("1b65"),b={data:function(){return{listData:[],multipleSelection:[],selectedData:{}}},mounted:function(){this.fetchHeaderData()},methods:{handleSelectionChange:function(t){this.multipleSelection=t},fetchHeaderData:function(){var t=this;Object(v["c"])().then((function(e){var i=e.list;t.listData=i.map((function(t){return t.fields.headers=t.fields.header.split("_|_"),t}))}))},fetchSeletion:function(){this.selectedData={};for(var t=0;t<this.multipleSelection.length;t++){var e=this.multipleSelection[t],i=e.fields.filefrom,a=e.fields.sheetname||"_csv_",l=e.fields.headers;if(void 0===this.selectedData[i]&&(this.selectedData[i]={},this.selectedData[i]["value"]=e.fields.filepath,this.selectedData[i]["label"]=e.fields.filename,this.selectedData[i]["children"]=[]),this.selectedData[i])var n={};n["value"]=a,n["label"]=a,n["children"]=l.map((function(t){var e={};return e["value"]=t,e["label"]=t,e})),this.selectedData[i]["children"].push(n)}}}},_=b,g=(i("73f7"),Object(u["a"])(_,h,m,!1,null,"4884c0d0",null)),w=g.exports,y=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-table",{staticStyle:{width:"100%"},attrs:{data:t.modelList.variable,stripe:""}},[i("el-table-column",{attrs:{prop:"key",align:"center",label:"变量",width:"180"}}),i("el-table-column",{attrs:{label:"字段","min-width":"2"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-cascader",{staticStyle:{width:"80%"},attrs:{options:t.dataList,filterable:""},model:{value:e.row.val,callback:function(i){t.$set(e.row,"val",i)},expression:"scope.row.val"}})]}}])})],1)},S=[],E={props:{modelList:{type:Object,default:function(){return{variable:[]}}},dataList:{type:Array,default:function(){return[]}}},data:function(){return{dataAndModel:{}}},methods:{fetchMapper:function(){this.dataAndModel=this.modelList}}},A=E,x=Object(u["a"])(A,y,S,!1,null,null,null),k=x.exports,O=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"chart-container"},[i("el-row",{attrs:{gutter:20}},[i("el-col",{attrs:{span:16}},[i("div",{attrs:{id:"line-chart-container"}},[i("chart",{attrs:{height:t.height,width:t.width,"line-data":t.lineData}})],1)]),i("el-col",{attrs:{span:6}},[i("div",{},[i("el-table",{staticStyle:{width:"100%"},attrs:{data:t.lineData,height:"550"}},[i("el-table-column",{attrs:{label:"序号",type:"index",width:"50"}}),i("el-table-column",{attrs:{label:"结果",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",[t._v(t._s(e.row))])]}}])})],1)],1)])],1)],1)},D=[],P=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{class:t.className,style:{height:t.height,width:t.width},attrs:{id:t.id}})},V=[],U=i("313e"),C=i.n(U),L={props:{lineData:{type:Array,default:function(){return[]}},className:{type:String,default:"chart"},id:{type:String,default:"chart"},width:{type:String,default:"200px"},height:{type:String,default:"200px"}},data:function(){return{chart:null}},watch:{lineData:{handler:function(t){this.chart.resize();for(var e=[],i=0;i<t.length;i++)e.push([i,t[i]]);console.log("lineData Change",e),this.chart.setOption({series:[{data:e}]})},deep:!0}},mounted:function(){console.log("图形被挂载了"),this.initChart()},beforeDestroy:function(){this.chart&&(this.chart.dispose(),this.chart=null)},methods:{initChart:function(){this.chart=C.a.init(document.getElementById(this.id)),this.chart.setOption({backgroundColor:"#394056",title:{top:20,text:"Requests",textStyle:{fontWeight:"normal",fontSize:16,color:"#F1F1F3"},left:"1%"},tooltip:{trigger:"axis",axisPointer:{lineStyle:{color:"#57617B"}}},toolbox:{feature:{dataZoom:{yAxisIndex:"none"},restore:{},saveAsImage:{}}},legend:{top:20,icon:"rect",itemWidth:14,itemHeight:5,itemGap:13,data:["PAT"],right:"4%",textStyle:{fontSize:12,color:"#F1F1F3"}},grid:{top:100,left:"2%",right:"2%",bottom:"2%",containLabel:!0},xAxis:[{type:"category",boundaryGap:!1,axisLine:{lineStyle:{color:"#57617B"}}}],yAxis:[{type:"value",axisTick:{show:!1},axisLine:{lineStyle:{color:"#57617B"}},axisLabel:{margin:10,textStyle:{fontSize:14}},splitLine:{lineStyle:{color:"#57617B"}}}],dataZoom:[{type:"inside"},{}],series:[{name:"PAT",type:"line",smooth:!0,symbol:"circle",symbolSize:5,showSymbol:!1,lineStyle:{normal:{width:1}},areaStyle:{normal:{color:new C.a.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"rgba(137, 189, 27, 0.3)"},{offset:.8,color:"rgba(137, 189, 27, 0)"}],!1),shadowColor:"rgba(0, 0, 0, 0.1)",shadowBlur:10}},itemStyle:{normal:{color:"rgb(137,189,27)",borderColor:"rgba(137,189,2,0.27)",borderWidth:12}},data:[220,182,191,134,150,120,110,125,145,122,165,122]}]})}}},R=L,j=Object(u["a"])(R,P,V,!1,null,null,null),N=j.exports,B={name:"ShowResult",components:{Chart:N},props:{className:{type:String,default:"chart"},id:{type:String,default:"chart"},width:{type:String,default:"200px"},height:{type:String,default:"200px"},modelAndData:{type:Object,default:function(){return{variable:[]}}}},data:function(){return{lineData:[]}},watch:{modelAndData:{handler:function(){}}},mounted:function(){},methods:{run:function(t){var e=this,i=JSON.stringify(t);Object(o["a"])(i).then((function(t){var i=t.result.split("_|_");e.lineData=i,console.log(i)}))}}},$=B,M=(i("0f3f"),Object(u["a"])($,O,D,!1,null,"6af1740c",null)),I=M.exports,z={name:"ModelAnalysis",components:{Model3E:p,Datafields:w,Mapper:k,ShowResult:I},data:function(){return{height:"400px",width:"800px",active:1,list:null,currentRow:null,listLoading:!0,total:0,triggerNextTimes:"",selectedModel:{pk:"",variable:[]},selectedData:[],selectedDataAndModel:{}}},watch:{selectedDataAndModel:function(t,e){console.log(t,"selectedDataAndModel Change!",e)}},created:function(){},mounted:function(){this.width=Math.ceil(this.$refs.modelContainer.offsetWidth/2)+"px",console.log(this.width)},methods:{handleModel:function(){},next:function(){var t=this;if(1===this.active){var e=this.$refs.model.tmp;""===e.pk?this.$message({showClose:!0,message:"请先选择模型",type:"error"}):(this.selectedModel={pk:e.pk,coefficient:e.coefficient,variable:e.variable.map((function(t){var e={};return e["key"]=t,e["val"]=null,e}))},this.active++)}else{if(2===this.active){this.$refs.datafields.fetchSeletion();var i=this.$refs.datafields.selectedData;this.selectedData=[],Object.keys(i).forEach((function(e){t.selectedData.push(i[e])}))}4===this.active||(0===this.selectedData.length?this.$message({showClose:!0,message:"请先选择您需要使用的数据文件，勾选表示选中。",type:"error"}):(3===this.active&&(this.$refs.mapper.fetchMapper(),this.selectedDataAndModel=this.$refs.mapper.dataAndModel,this.$refs.showresult.run(this.selectedDataAndModel)),this.active++))}},last:function(){this.active>1&&this.active--}}},T=z,J=(i("08ae"),Object(u["a"])(T,a,l,!1,null,"7e1c57db",null));e["default"]=J.exports},f506:function(t,e,i){}}]);